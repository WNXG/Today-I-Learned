<template>
    <div id="app">
        <el-table
                :data="tableData"
                style="width: 100%"
                height="250"
                ref="myTable">
            <el-table-column
                    type="index"
                    width="50">
            </el-table-column>
            <el-table-column
                    prop="email"
                    label="邮箱">
            </el-table-column>
            <el-table-column
                    prop="name"
                    label="姓名">
            </el-table-column>
            <el-table-column
                    prop="address"
                    label="地址">
            </el-table-column>
        </el-table>
    </div>
</template>
<script>
    import jsonData from './../data/data.json'

    export default {
        name: 'Table',
        components: {},
        data() {
            return {
                tableData: [],
                currentPage: 1,
                pageSize: 10,
                totalPage: 0
            }
        },
        created() {
            this.totalPage = jsonData.length / this.pageSize
            this.loadData()
        },
        mounted() {
            this.tableListener()
        },
        methods: {
            loadData() {
                console.log('getData')
                //这里模拟请求数据，最后一页数据不够pageSize时有BUG，暂不处理
                let data = jsonData.splice((this.currentPage - 1) * this.pageSize, this.pageSize)
                this.tableData = this.tableData.concat(data);
                console.log("表格数据量：",this.tableData.length)
            },
            tableListener() {
                console.log("监听表格dom对象的滚动事件")
                let that = this;
                let dom = that.$refs.myTable.bodyWrapper
                dom.addEventListener("scroll", function () {
                    const scrollDistance = dom.scrollHeight - dom.scrollTop - dom.clientHeight;
                    // console.log("scroll", scrollDistance)
                    if (scrollDistance <= 0) {//等于0证明已经到底，可以请求接口
                        if (that.currentPage < that.totalPage) {//当前页数小于总页数就请求
                            that.currentPage++;//当前页数自增
                            //请求接口的代码
                            that.loadData()
                        }
                    }
                })
            }
        },
    }

</script>

```
addEventListenerTableList(){
  this.dom = this.$refs.tabList.bodyWrapper
  let i = 0 //这里设置i=0是因为在监听外面拿到的scrollHeight不对，所以需要在监听里面拿到第一次的的高度
  let firstHeight = 0
  this.dom.addEventListener('scroll', () => {
    i ++
    // 滚动距离
    if (i == 1){
      firstHeight = this.dom.scrollHeight || this.dom.scrollHeight
    }
    let scrollTop = this.dom.scrollTop
    // 变量windowHeight是可视区的高度
    let windowHeight = this.dom.clientHeight || this.dom.clientHeight
    // 变量scrollHeight是滚动条的总高度
    let scrollHeight = this.dom.scrollHeight || this.dom.scrollHeight
    if (scrollTop + windowHeight == scrollHeight){// 判断滚动条是否已经拉到了最下面
      let i = scrollHeight/firstHeight
      let sliceArrData = this.cross_table7.slice(20*i, 20*(i+1))//此处的cross_table7是存储的拿到的几万条数据，每次滚动条到最下的时候截取20条然后放到页面展示的table表格中
      this.cross_table2 = this.cross_table2.concat(sliceArrData)
    }
  })
},
```

1105
:data="foods.filter((data) => !search || data.name.toLowerCase().includes(search.toLowerCase()))"

1107
今天终于开始 app 了 历经磨难终于打开了正确的代码
难受 但是没有正确关联 烦 还要改 证明我和这个 app 开发真的八字不合
一开始就一堆问题 烦捏

1109
昨天主要在搞 ios 不能滑动的问题 不知道解决没解决
今天要发布小程序 制作二维码 然后就是 app 固定底部那两个按钮
今天改了整整一天小程序的 bug 学到个新的 git 命令 git revert 版本回退
呜呜
随着小程序发布 一堆问题浮上线
